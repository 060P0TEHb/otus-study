# Home work 3 (LVM)
В данный vagrant файл добавлены след. опции:

- Загружается бокс "Centos 7" версии 1804.02
- Виртуальной машине выделяется 2048M RAM и 2 cpu
- Создаются дополнительные диски в папке ~/VirtualBox VMs/lvm/. Нужно обратить внимание, что бы папка была пуста
- Средствами vagrant-а выполняется конфигурация, разрешающая логин root-а. Необходимо для lvm_snapshot плейбука.

Далее из корневой папки проекта (Lesson3) можно выполнить след. плейбуки:
- resize_xfs.yml - выполнит уменьшение xfs файловой системе на первом диске до 8G, тем самым даст возможность выполниться lvm_*.yml плейбукам
  - Данный плейбук разделен тэгами на 3 части (stage1\2\3) - соответственно backup,restore и clear стадии (последняя очищается диск /dev/sdb ). После каждой стадии выполняется вывод дигностической информации в консоль, по которой можно проследить процесс выполнения.
  - Плэйбук выполняется с двумя перезгразками.
- lvm_mirror.yml - выполняет создание mirror LV,  автомонтирование в var с последующим backup данных. Конфигурация прописывается в fstab. /var на основном диске удаляется.
  - Плэйбук выполняется с перезагрузкой, что бы отпустить нектороые FD в /var.
- lvm_snapshot.yml - разделен на 2 стадии. 1 стадия выполняет перенос каталога /home на отдельные LV. Вторая стадия создает файлы внутри /home, снимает snapshot, заменяет файлы и откатывается на предыдущие состояние - все действия показываются в консоли (создание\удаление\восстановление).
  - Плэйбук выполняется без перезагрузки. Повторный запуск выполняет только пример со снапшотами (создание\удаление\восстановление)
- zfs_show.yml  - задание со звездочкой. Выбрал zfs. Происходит добавление репозитория, скачивание пакета и включение нужного модуля в ядре.
После идет демонстрация некоторых свойств - создается зеркальный диск, записываются туда данные. Один из дисков на лету меняется на другой. Снимается\восстанавливается снэпшот и импортируется на другой диск.
В конце плейбука очищаются все 3 (sd[d,e,f]) диска.
  - Плэйбук может выполняться неограничение кол-во раз, при условие что присутствуют диски /dev/sd[d,e,f] и у них общий объем

В каждом плейбуке присутствует минимальная защита от ошибок - условия, что бы не запускать одноразовые действия повторно.
